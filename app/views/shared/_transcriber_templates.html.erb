
<script type="text/template" id="main-layout-template">
    <div id="transcriber-toolbar">

    </div>
    <div id="transcription-msg-container"></div>
    <div id="header-wrapper">
        <div id="header-img-spacer">&nbsp;</div>
        <div id="header-image-container"></div>
    </div>
    <div id="page-time-container">
        <div id="time-image-container"></div>
        <div id="page-container"></div>
    </div>

</script>

<script type="text/template" id="transcription-toolbar-template">
    <div id="transcription-buttons" class="btn-toolbar" role="toolbar">
        <div class="btn-group" role="group" data-purpose="guide and help">
            <a href="/tutorial" target="tutorial" class="btn btn-default">Instructions</a>
            <a href="/feedback" target="feedback" class="btn btn-default">Feedback</a>
        </div>
        <div class="btn-group" role="group" data-purpose="action buttons">
            <button id="new-annotation" type="button" class="btn btn-primary">New Annotation</button>
            <!-- <button id="toggle-annoation-display" type="button" class="btn btn-default">Toggle annotation boxes</button> -->
        </div>
        <div id="get-started-txt" class="btn-group" role="group" data-purpose="guide and help">
            <i class="fa fa-arrow-left"></i>  Click on "New Annotation" to transcribe
        </div>
    </div>
    <div id="transcription-form-container">
            <%= form_for transcription, html: {class: "form-inline", id: "submit-transcription-form"} do %>
                <% if transcription.complete %>
                    <%= submit_tag "Submit Finished Transcription", data: { confirm: "Are you sure?" }, style: "margin-left: 20px;", class: "btn btn-success pull-right", id: "finish-transcribing-btn" %>
                <% else %>
                    <%= submit_tag "Take a Break", data: { confirm: "Are you sure?" }, style: "margin-left: 20px;", class: "btn btn-default pull-right", id: "finish-transcribing-btn" %>
                <% end %>

                <%= hidden_field_tag "transcription[complete]", false %>
                <%= check_box_tag "transcription[complete]", true, transcription.complete, id: "page-complete-checkbox" %>
            <% end %>
    </div>

</script>

<script type="text/template" id="page-canvas-template">
    <img src="<%= page.image.url(:original) %>" alt="" id="target-image">
</script>

<script type="text/template" id="page-image-template">
    <div class="control-mask">
        <div class="actions-container">
            <span class="btn btn-xs btn-default default-position-btn">Default Position</span>
            <span class="btn btn-xs btn-default adjust-position-btn">Reposition Image</span>
        </div>
        <div class="description-msg">{{= description_msg }}</div>
        <div class="action-msg">{{= action_msg }}</div>
    </div>
    <img src="<%= page.image.url(:original) %>" id="{{= image_id }}">
</script>

<script type="text/template" id="msg-template"> 
        <span id="msg">{{= text }}</span><button type="button" class="close pull-right" aria-label="Close"><span aria-hidden="true"><i class="fa fa-remove"></i></span></button> 
</script> 

<script id="annotation-box-template" type="text/template">
    <div class="inner">
        <div class="annotation-actions">
            <button type="button" class="btn btn-xs btn-default edit-annotation-btn" data-toggle="tooltip" data-trigger="hover" data-container="#canvas" title="edit values"><i class="fa fa-pencil"></i></button>
            <button type="button" class="btn btn-xs btn-default resize-annotation-btn" data-toggle="tooltip" data-trigger="hover" data-container="#canvas" title="resize box"><i class="fa fa-expand" aria-hidden="true"></i></button>
            <button type="button" class="btn btn-xs btn-default move-annotation-btn" data-toggle="tooltip" data-trigger="hover" data-container="#canvas" title="reposition box"><i class="fa fa-arrows" aria-hidden="true"></i></button>

            <button type="button" class="btn btn-xs btn-danger delete-annotation-btn pull-right" data-toggle="tooltip" data-trigger="hover" data-container="#canvas" title="delete annotation"><i class="fa fa-trash"></i></button>
        </div>
        <div class="annotation-msg"></div>
    </div>
</script>

<script type="text/template" id="transcription-box-template">
    <div id="scribe_transcription_area">
        <div id="scribe_top_bar">
            <div id="scribe_prompt">
                <p id="scribe_prompt_text">Enter the values for each field to be transcribed</p>
                <button class="btn btn-default btn-xs pull-right close-btn" style="border: none;"><i class="fa fa-close fa-2x"></i></button>
            </div>
            <ul id="scribe_tab_bar">
                <% field_groups.each do |field_group| %>
                    <% if field_group.fields.any? %>
                        <li id="scribe_tab_<%= field_group.id %>" class="scribe_tab <%= field_group.colour_class %>" data-field-group-id="<%= field_group.id %>" data-field-count=<%= field_group.fields.count + 3 %>><%= field_group.presentation_name %></li>
                    <% end %>
                <% end %>
            </ul>
        </div>
        <div id="scribe_bottom_area">
            <div id="scribe_input_bar">
                <div id="formInstructions">Click a tab to begin</div>
                <% field_groups.each do |field_group| %>
                    <div id="field-group-<%= field_group.id %>" class="annotation-form-field-group" style="display:none;">
                        <% if field_group.help.present? %>
                            <p class="field-group-help-text"><%= field_group.help.html_safe %></p>
                        <% end %>
                        <%= form_tag annotations_path, id: ("field_group_" + field_group.id.to_s), class:"annotation-form", remote: true, format: :json, data: {field_group_id: field_group.id } do %>
                            <%= hidden_field_tag "filename", page.image_file_name %>
                            <%= hidden_field_tag "annotation[meta][transcription_id]", transcription.id %>
                            <%= hidden_field_tag "annotation[meta][page_id]", page.id %>
                            <%= hidden_field_tag "annotation[meta][field_group_id]", field_group.id %>
                            <%= hidden_field_tag "annotation[meta][x_tl]", nil, id: "x-field" %>
                            <%= hidden_field_tag "annotation[meta][y_tl]", nil, id: "y-field" %>
                            <%= hidden_field_tag "annotation[meta][width]", nil, id: "width-field" %>
                            <%= hidden_field_tag "annotation[meta][height]", nil, id: "height-field" %>
                            
                            <div class="user-input-container">
                                <div class="scribe_input_field datetime">
                                    <div class="scribe_input_label">
                                        <div class="input-group datetime-group" id="time-<%= field_group.id.to_s %>">
                                            <%= text_field_tag "annotation[observation_date]", nil, required: true, class: "observation-input do-not-clear form-control datetime-field", title: "Observation Date and Time" %>
                                            <span class="input-group-addon">
                                                <span class="glyphicon glyphicon-time"></span>
                                            </span>
                                        </div>
                                        <div>
                                            <%= content_tag "i", "", class: "fa fa-info-circle", style: "cursor: help;", title: "Observation Date and Time", data: { content: "What is the date and time of this observation? <b>You can select the date and time by clicking on the clock icon.</b><br>Should follow the format <nobr><code>04 Aug 1874, 01:48 AM</code></nobr>.", html: true, toggle: "popover", placement: "bottom auto", trigger: "hover"}%> Observation Date and Time
                                        </div>
                                    </div>
                                </div>
                                
                                <% field_group.fields.each do |field| %>
                                    <div class="scribe_input_field" data-field-id="<%= field.id %>">
                                        <%= hidden_field_tag "annotation[data][#{field.field_key.downcase.gsub(" ", "_")}][page_id]", page.id %>
                                        <%= hidden_field_tag "annotation[data][#{field.field_key.downcase.gsub(" ", "_")}][user_id]", current_user.id %>
                                        <%= hidden_field_tag "annotation[data][#{field.field_key.downcase.gsub(" ", "_")}][field_id]", field.id, data: {field_type: "field_id"} %>
                                        <%= hidden_field_tag "annotation[data][#{field.field_key.downcase.gsub(" ", "_")}][data_type]", field.data_type %>
                                        <%= hidden_field_tag "annotation[data][#{field.field_key.downcase.gsub(" ", "_")}][selected_option_ids]", nil, class: "selected-option-ids" %>
                                        <div class="scribe_input_label">
                                        <% if field.field_options.any? %>
                                            <%= select_tag "annotation[data][#{field.field_key.downcase.gsub(" ", "_")}][value]", nil, class: "observation-input form-control selectable", multiple: field.multi_select,  data: { field_id: field.id, field_type: "field_value", selectable: true, field_options: true, multiple: field.multi_select, tags: field.multi_select } %>
                                        <% else %>
                                            <%= select_tag "annotation[data][#{field.field_key.downcase.gsub(" ", "_")}][value]", nil, class: "observation-input form-control selectable", data: { field_id: field.id, field_type: "field_value", selectable: true, field_options: false } %>
                                        <% end %>
                                        <i class="fa fa-info-circle" style="cursor: help;" aria-hidden="true" title="<%= (field.full_name && field.full_name.present? ? field.full_name : field.name) %>" data-toggle="popover" data-trigger="hover" data-placement="left auto" data-content="<%= (field.help && field.help.present? ? field.help : "") %>"></i><%= field.name %>
                                        </div>
                                    </div>
                                <% end %>
                                <%= button_tag "Save", class:"submit-btn btn btn-primary btn-md scribe-input-field", style: "margin-top: 10px;" %>
                            </div>
                        <% end %>
                    </div>
                <% end %>
            </div>
        </div>
    </div>
    <div id="transcriber-grid-container">
        <div class="control-mask">
            Position this box around the data you're transcribing
        </div>
    </div>

</script>

